pipeline:
  submodules:
    image: alpine/git
    commands:
      - git submodule update --init --recursive

  build:
    image: squidfunk/mkdocs-material:latest
    pull: true
    entrypoint: [/bin/sh]
    commands:
      - python3 -m pip install --no-cache-dir -r requirements.txt
      - mkdocs build --clean --verbose -d dev

  push:
    image: appleboy/drone-git-push
    settings:
      remote_name: origin
      branch: pages
      local_ref: pages
      ssh_key: 
        from_secret: key_ssh
      path: dev

when:
  branch: V3-Dev
  event: push
